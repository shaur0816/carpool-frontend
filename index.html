<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ä¸­è¯ä½›æ•™æ˜å¿ƒè¦‹æ€§å”æœƒï½œå…±ä¹˜ç™»è¨˜</title>

<link rel="icon" type="image/png" href="./icon.png" />
<link rel="apple-touch-icon" href="./icon.png" />
<link rel="apple-touch-icon" sizes="180x180" href="./icon.png" />

<style>
/* =======================
   ğŸŒ¿ å…¨åŸŸæ¨£å¼
======================= */
body {
  font-family: "Noto Sans TC", sans-serif;
  background: #f7f5e9;
  margin: 0;
  padding: 22px;
  color: #355e3b;
}

/* æ¨™é¡Œ */
h1 {
  text-align: center;
  font-size: 30px;
  margin: 0 0 18px 0;
  color: #2f5d3a;
  font-weight: 900;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
}

.icon {
  font-size: 30px;
}

/* é«˜éµè³‡è¨Šå¡ç‰‡ */
.pickup-card {
  background: #ffffff;
  padding: 28px;
  border-radius: 18px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  margin-bottom: 25px;
  font-size: 20px;
  line-height: 1.5;
  font-weight: 600;
  border-left: 6px solid #d4e157;
  text-align: center;
  color: #bb0505;
}

/* =======================
   ğŸŒ¿ æ™‚é–“æŒ‰éˆ•
======================= */
.time-buttons {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 25px;
}

.time-btn {
  padding: 18px;
  font-size: 22px;
  background: #5d8b6d;
  border-radius: 16px;
  border: 2px solid #446b52;
  color: white;
  cursor: pointer;
  width: 100%;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 12px;
  transition: 0.25s ease;
}

.time-btn:hover {
  background: #2e4d3a;
  border-color: #1d3327;
  transform: scale(1.03);
}

.time-btn.selected {
  background: #365d41;
  border-color: #1f3d2a;
  transform: scale(1.02);
}

/* =======================
   ğŸŒ¿ æ–°å¢å§“åå€
======================= */
.input-area {
  background: white;
  padding: 20px;
  border-radius: 18px;
  border: 2px solid #dce775;
  margin-bottom: 25px;
  text-align: center;
}

input {
  font-size: 22px;
  padding: 12px;
  width: 70%;
  border-radius: 12px;
  border: 3px solid #8bc34a;
  background: #fffde7;
}

.add-btn {
  background: #fbc02d;
  border: none;
  padding: 14px 22px;
  border-radius: 14px;
  font-size: 22px;
  color: #3e2723;
  margin-left: 10px;
  cursor: pointer;
  font-weight: 700;
  transition: 0.2s;
}

.add-btn:hover {
  background: #f9a825;
  transform: scale(1.05);
}

/* =======================
   ğŸŒ¿ åå–®åˆ—è¡¨
======================= */
.list {
  background: white;
  padding: 20px;
  border-radius: 18px;
  margin-bottom: 25px;
  border: 2px solid #dce775;
}

.list h2 {
  font-size: 24px;
  margin-top: 0;
  color: #33691e;
  font-weight: 900;
  display: flex;
  align-items: center;
  gap: 6px;
}

.route {
  font-size: 18px;
  margin-bottom: 10px;
  color: #4d6b3c;
}

.name-item {
  display: flex;
  justify-content: space-between;
  padding: 14px 16px;
  background: #fff9c4;
  border-radius: 14px;
  font-size: 22px;
  margin-bottom: 10px;
  border: 2px solid #f9e79f;
  align-items: center;
}

.remove-btn {
  background: #ff7043;
  color: white;
  padding: 8px 14px;
  border-radius: 12px;
  font-size: 18px;
  cursor: pointer;
  transition: 0.2s;
}

.remove-btn:hover {
  background: #e64a19;
  transform: scale(1.08);
}

.empty {
  color: #888;
  font-size: 18px;
  padding: 12px 0;
}

</style>
</head>

<body>

<h1>
  <span class="icon">ğŸƒ</span>
  ä¸­è¯ä½›æ•™æ˜å¿ƒè¦‹æ€§å”æœƒï½œå…±ä¹˜ç™»è¨˜
  <span class="icon">ğŸƒ</span>
</h1>

<div class="pickup-card">
  ğŸš— çƒæ—¥é«˜éµç«™ä¸Šè»Šåœ°é»ï¼š<br>1F è¼‰å®¢å€ 1 è™Ÿå‡ºå£ï¼ˆéè¨ˆç¨‹è»Šå€ï¼‰
</div>

<!-- æ™‚é–“æŒ‰éˆ• -->
<div class="time-buttons" id="btnArea"></div>

<!-- æ–°å¢å§“å -->
<div class="input-area">
  <input id="name" type="text" placeholder="è«‹è¼¸å…¥å§“å" />
  <button class="add-btn" onclick="addName()">åŠ å…¥</button>
</div>

<!-- åå–®åˆ—è¡¨ -->
<div id="lists"></div>

<script>
const API = "https://carpool.zeabur.app";

/* æ™‚é–“ / è·¯ç·šè³‡æ–™ */
const timeSlots = [
  "12/12(äº”ï¼‰15:40 å‰ä¸€å¤©å…¥ä½",
  "12/13ï¼ˆå…­ï¼‰07:30 è¦‹éƒ¨ä¸Šèª²",
  "12/14ï¼ˆæ—¥ï¼‰07:30 ä¿®éƒ¨ä¸Šèª²",
  "12/13ï¼ˆå…­ï¼‰17:30 è¦‹éƒ¨ä¸‹èª²",
  "12/14ï¼ˆæ—¥ï¼‰17:10 ä¿®éƒ¨ä¸‹èª²"
];

const routes = [
  "å»ç¨‹ï¼šçƒæ—¥é«˜éµ â†’ è˜ç•«å±…",
  "å»ç¨‹ï¼šçƒæ—¥é«˜éµ â†’ è˜ç•«å±…",
  "å»ç¨‹ï¼šçƒæ—¥é«˜éµ â†’ è˜ç•«å±…",
  "å›ç¨‹ï¼šè˜ç•«å±… â†’ çƒæ—¥é«˜éµ",
  "å›ç¨‹ï¼šè˜ç•«å±… â†’ çƒæ—¥é«˜éµ"
];

let data = [];
let selectedIndex = 0;

/* =============================
   ğŸŒ¿ æ™‚é–“æŒ‰éˆ•ç”¢ç”Ÿ
============================= */
const btnArea = document.getElementById("btnArea");
timeSlots.forEach((slot, i) => {
  const btn = document.createElement("button");
  btn.className = "time-btn";
  btn.textContent = `ğŸŒ² ${slot}`;

  if (i === 0) btn.classList.add("selected");

  btn.onclick = () => {
    document.querySelectorAll(".time-btn").forEach(b => b.classList.remove("selected"));
    btn.classList.add("selected");
    selectedIndex = i;
  };

  btnArea.appendChild(btn);
});

/* =============================
   ğŸŒ¿ è¼‰å…¥åå–®
============================= */
async function loadList() {
  const res = await fetch(`${API}/list`);
  data = await res.json();
  renderLists();
}
loadList();

/* =============================
   ğŸŒ¿ æ¸²æŸ“åå–®ï¼ˆæ­£ç¢ºç‰ˆï¼‰
============================= */
function renderLists() {
  const lists = document.getElementById("lists");
  lists.innerHTML = "";

  timeSlots.forEach((slot, i) => {
    const div = document.createElement("div");
    div.className = "list";
    div.id = "list-" + i;

    div.innerHTML += `
      <h2>ğŸ€ ${slot}</h2>
      <div class="route">${routes[i]}</div>
    `;

    if (!data[i] || data[i].length === 0) {
      div.innerHTML += `<div class="empty">å°šç„¡ç™»è¨˜è€…</div>`;
    } else {
      data[i].forEach((name, idx) => {
        const row = document.createElement("div");
        row.className = "name-item";

        row.innerHTML = `
          <span>ğŸŒ± ${name}</span>
          <button class="remove-btn" onclick="removeName(${i}, ${idx})">åˆªé™¤</button>
        `;

        div.appendChild(row);
      });
    }

    lists.appendChild(div);
  });
}

/* =============================
   ğŸŒ¿ æ–°å¢å§“å
============================= */
async function addName() {
  const name = document.getElementById("name").value.trim();
  if (!name) return alert("è«‹è¼¸å…¥å§“å");

  await fetch(`${API}/add`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ columnIndex: selectedIndex, name }),
  });

  document.getElementById("name").value = "";
  loadList();
}

/* =============================
   ğŸŒ¿ åˆªé™¤å§“åï¼ˆæ­£ç¢ºå°æ‡‰ Sheetsï¼‰
============================= */
async function removeName(col, rowIndex) {
  if (!confirm("ç¢ºèªåˆªé™¤ï¼Ÿ")) return;

  await fetch(`${API}/delete`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ columnIndex: col, rowIndex }),
  });

  loadList();
}
</script>

</body>
</html>
